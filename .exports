#!/usr/bin/env bash

# Make VS Code the default editor.
export EDITOR='code -w';

# Except for git
export GIT_EDITOR='vim -c startinsert';

# Make Python use UTF-8 encoding for output to stdin, stdout, and stderr.
export PYTHONIOENCODING='UTF-8';

# Increase Bash history size. Allow 64³ entries; the default is 500.
export HISTSIZE='262144';
export HISTFILESIZE='524288';
# Omit duplicates and commands that begin with a space from history.
export HISTCONTROL='ignoreboth';
# log timestamps in history
export HISTTIMEFORMAT="%F %T "
# Make some commands not show up in history
export HISTIGNORE="ll:ls:l:..:cd:cd -:gg:pwd:exit:date"
# Immediately append to history file
export PROMPT_COMMAND="${PROMPT_COMMAND}; history -a"

# Prefer US English and use UTF-8.
export LANG='en_US.UTF-8';
export LC_ALL='en_US.UTF-8';

# Highlight section titles in manual pages.
export LESS_TERMCAP_md="${yellow}";

# Don’t clear the screen after quitting a manual page.
export MANPAGER='less -X';

# Opt-out of Homebrew analytics
export HOMEBREW_NO_ANALYTICS=1

# Avoid issues with `gpg` as installed via Homebrew.
# https://stackoverflow.com/a/42265848/96656
# export GPG_TTY=$(tty);

# Install Nord dircolors
# Based of https://www.nordtheme.com/docs/ports/dircolors/installation
# With changes so that it runs on this system
test -r ~/.dir_colors && eval $(gdircolors ~/.dir_colors)

# Shell Bookmarks
# http://jeroenjanssens.com/2013/08/16/quickly-navigate-your-filesystem-from-the-command-line.html
export MARKPATH=$HOME/.marks

# http://owen.cymru/fzf-ripgrep-navigate-with-bash-faster-than-ever-before/
# Use RipGrep for better search
export FZF_DEFAULT_COMMAND='rg --files --no-ignore --hidden --follow -g "!{.git,node_modules,target}/*" 2> /dev/null'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_ALT_C_COMMAND="cd ${HOME}/dev; bfs -type d -nohidden | sed s*^\.*${HOME}/dev*"
bind -x '"\C-x\C-p": vim $(fzf);'

# fw: https://github.com/brocode/fw/blob/b797b3c51e1400400b2d9b5c2b602b7c733e4f5b/doc/installation.org
if [[ -x "$(command -v fw)" ]]; then
  if [[ -x "$(command -v fzf)" ]]; then
    eval "$(fw print-bash-setup -f 2>/dev/null)"
  else
    eval "$(fw print-bash-setup 2>/dev/null)"
  fi
fi

# SDKMAN
export SDKMAN_DIR="${HOME}/.sdkman"
